!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","lodash"],t):t((e.angular2=e.angular2||{},e.angular2.data=e.angular2.data||{},e.angular2.data.table=e.angular2.data.table||{}),e.ng.core,e.ng.common,e._)}(this,function(e,t,n,a){"use strict";var i=function(e,t,n,a){var i,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},o=function(){function e(){this._locStorVar="ng2-data-table-pagination"}return e.prototype.getPagination=function(){var e=window.localStorage.getItem(this._locStorVar);return e?parseInt(e):1e3},e.prototype.setPagination=function(e){window.localStorage.setItem(this._locStorVar,e)},e=i([t.Injectable()],e)}(),s=function(e,t,n,a){var i,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=function(){function e(e){this.stateManager=e,this.inputData=[],this.sortBy="",this.sortOrder="asc",this.rowsOnPage=1e3,this.saveRowsOnPage=!1,this.activePage=1,this.selectedEntitiesEmitter=new t.EventEmitter,this.selectedEntities=[],this.mustRecalculateData=!1,this.onDataChange=new t.EventEmitter,this.onSortChange=new t.EventEmitter,this.onPageChange=new t.EventEmitter,this.onSelectChange=new t.EventEmitter}return e.prototype.addRemoveSelectedEntity=function(e){this.onSelectChange.emit({}),this.updateSelectedEntities(),this.selectedEntitiesEmitter.emit(this.selectedEntities)},e.prototype.updateSelectedEntities=function(){this.selectedEntities=this.inputData.filter(function(e){return e.__isSelected__})},e.prototype.selectAllRows=function(){this.inputData.forEach(function(e){e.__isSelected__=!0}),this.updateSelectedEntities(),this.selectedEntitiesEmitter.emit(this.selectedEntities)},e.prototype.deselectAllRows=function(){this.inputData.forEach(function(e){e.__isSelected__=!1}),this.updateSelectedEntities(),this.selectedEntitiesEmitter.emit(this.selectedEntities)},e.prototype.getSort=function(){return{sortBy:this.sortBy,sortOrder:this.sortOrder}},e.prototype.setSort=function(e,t){this.sortBy===e&&this.sortOrder===t||(this.sortBy=e,this.sortOrder=t,this.mustRecalculateData=!0,this.onSortChange.emit({sortBy:e,sortOrder:t}))},e.prototype.getPage=function(){return{activePage:this.activePage,rowsOnPage:this.rowsOnPage,saveRowsOnPage:this.saveRowsOnPage,dataLength:this.inputData.length}},e.prototype.setPage=function(e,t){this.rowsOnPage===t&&this.activePage===e||(this.activePage=this.activePage!==e?e:this.calculateNewActivePage(this.rowsOnPage,t),this.rowsOnPage=t,this.mustRecalculateData=!0,this.onPageChange.emit({activePage:this.activePage,rowsOnPage:this.rowsOnPage,saveRowsOnPage:this.saveRowsOnPage,dataLength:this.inputData.length}))},e.prototype.calculateNewActivePage=function(e,t){var n=(this.activePage-1)*e+1;return Math.ceil(n/t)},e.prototype.ngOnInit=function(){this.inputDataLength=this.inputData.length,this.saveRowsOnPage&&(this.rowsOnPage=this.stateManager.getPagination())},e.prototype.ngOnChanges=function(e){e.inputData&&(this.mustRecalculateData=!0,this.ngDoCheck())},e.prototype.addIsSelectedProperty=function(){this.inputData.forEach(function(e){null==e.__isSelected__&&Object.defineProperty(e,"__isSelected__",{value:!1,writable:!0})})},e.prototype.ngDoCheck=function(){(this.mustRecalculateData||this.isInputDataChanged())&&(this.addIsSelectedProperty(),this.inputData=this.inputData||[],this.onPageChange.emit({activePage:this.activePage,rowsOnPage:this.rowsOnPage,saveRowsOnPage:this.saveRowsOnPage,dataLength:this.inputData.length}),this.onDataChange.emit({length:this.inputData.length}),this.fillData(),this.mustRecalculateData=!1)},e.prototype.isInputDataChanged=function(){var e=this.inputDataLength!=this.inputData.length;return this.inputDataLength=this.inputData.length,e},e.prototype.fillData=function(){var e=this;this.activePage=this.activePage,this.rowsOnPage=this.rowsOnPage;var t=(this.activePage-1)*this.rowsOnPage,n=this.inputData;n=a.orderBy(n,function(t){var n=t[e.sortBy];return n&&"string"==typeof n||n instanceof String?n.toLowerCase():n},[this.sortOrder]),n=a.slice(n,t,t+this.rowsOnPage),this.data=n},s([t.Input("mfData"),r("design:type",Array)],e.prototype,"inputData",void 0),s([t.Input("mfRowsOnPage"),r("design:type",Object)],e.prototype,"rowsOnPage",void 0),s([t.Input("mfSaveRowsOnPage"),r("design:type",Object)],e.prototype,"saveRowsOnPage",void 0),s([t.Input("mfActivePage"),r("design:type",Object)],e.prototype,"activePage",void 0),s([t.Output("mfSelectedEntities"),r("design:type",Object)],e.prototype,"selectedEntitiesEmitter",void 0),e=s([t.Directive({selector:"table[mfData]",exportAs:"mfDataTable"}),r("design:paramtypes",[o])],e)}(),l=function(e,t,n,a){var i,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},p=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(){function e(){this.rowsOnPageSet=[],this.minRowsOnPage=0}return e.prototype.ngOnChanges=function(e){e.rowsOnPageSet&&(this.minRowsOnPage=a.min(this.rowsOnPageSet))},l([t.Input("rowsOnPageSet"),p("design:type",Object)],e.prototype,"rowsOnPageSet",void 0),l([t.Input("mfTable"),p("design:type",c)],e.prototype,"mfTable",void 0),l([t.Input("savePagination"),p("design:type",Boolean)],e.prototype,"savePagination",void 0),e=l([t.Component({selector:"mfBootstrapPaginator",template:'\n    <mfPaginator #p [mfTable]="mfTable">\n        <nav class="pagination" *ngIf="p.dataLength > p.rowsOnPage">\n            <li [class.disabled]="p.activePage <= 1" (click)="p.setPage(1)">\n                <a style="cursor: pointer">&laquo;</a>\n            </li>\n            <li *ngIf="p.activePage > 4 && p.activePage + 1 > p.lastPage" (click)="p.setPage(p.activePage - 4)">\n                <a style="cursor: pointer">{{p.activePage-4}}</a>\n            </li>\n            <li *ngIf="p.activePage > 3 && p.activePage + 2 > p.lastPage" (click)="p.setPage(p.activePage - 3)">\n                <a style="cursor: pointer">{{p.activePage-3}}</a>\n            </li>\n            <li *ngIf="p.activePage > 2" (click)="p.setPage(p.activePage - 2)">\n                <a style="cursor: pointer">{{p.activePage-2}}</a>\n            </li>\n            <li *ngIf="p.activePage > 1" (click)="p.setPage(p.activePage - 1)">\n                <a style="cursor: pointer">{{p.activePage-1}}</a>\n            </li>\n            <li class="active">\n                <a style="cursor: pointer">{{p.activePage}}</a>\n            </li>\n            <li *ngIf="p.activePage + 1 <= p.lastPage" (click)="p.setPage(p.activePage + 1)">\n                <a style="cursor: pointer">{{p.activePage+1}}</a>\n            </li>\n            <li *ngIf="p.activePage + 2 <= p.lastPage" (click)="p.setPage(p.activePage + 2)">\n                <a style="cursor: pointer">{{p.activePage+2}}</a>\n            </li>\n            <li *ngIf="p.activePage + 3 <= p.lastPage && p.activePage < 3" (click)="p.setPage(p.activePage + 3)">\n                <a style="cursor: pointer">{{p.activePage+3}}</a>\n            </li>\n            <li *ngIf="p.activePage + 4 <= p.lastPage && p.activePage < 2" (click)="p.setPage(p.activePage + 4)">\n                <a style="cursor: pointer">{{p.activePage+4}}</a>\n            </li>\n            <li [class.disabled]="p.activePage >= p.lastPage" (click)="p.setPage(p.lastPage)">\n                <a style="cursor: pointer">&raquo;</a>\n            </li>\n        </nav>\n        <nav class="pagination pull-right" *ngIf="p.dataLength > minRowsOnPage">\n            <li *ngFor="let rows of rowsOnPageSet" [class.active]="p.rowsOnPage===rows" (click)="p.setRowsOnPage(rows)">\n                <a style="cursor: pointer">{{rows}}</a>\n            </li>\n        </nav>\n    </mfPaginator>\n    '})],e)}(),f=function(e,t,n,a){var i,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(){function e(e){var t=this;this.mfTable=e,this.isSortedByMeAsc=!1,this.isSortedByMeDesc=!1,e.onSortChange.subscribe(function(e){t.isSortedByMeAsc=e.sortBy===t.sortBy&&"asc"===e.sortOrder,t.isSortedByMeDesc=e.sortBy===t.sortBy&&"desc"===e.sortOrder})}return e.prototype.sort=function(){this.isSortedByMeAsc?this.mfTable.setSort(this.sortBy,"desc"):this.mfTable.setSort(this.sortBy,"asc")},f([t.Input("by"),h("design:type",String)],e.prototype,"sortBy",void 0),e=f([t.Component({selector:"mfDefaultSorter",template:'\n        <a style="cursor: pointer" (click)="sort()" class="text-nowrap">\n            <ng-content></ng-content>\n            <span *ngIf="isSortedByMeAsc" class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>\n            <span *ngIf="isSortedByMeDesc" class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>\n        </a>'}),h("design:paramtypes",[c])],e)}(),d=function(e,t,n,a){var i,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},y=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(e,t){return function(n,a){t(n,a,e)}},v=function(){function e(e,t){var n=this;this.injectMfTable=e,this.stateManager=t,this.dataLength=0,this.onPageChangeSubscriber=function(e){n.activePage=e.activePage,n.rowsOnPage=e.rowsOnPage,n.dataLength=e.dataLength,n.lastPage=Math.ceil(n.dataLength/n.rowsOnPage)}}return e.prototype.ngOnChanges=function(e){this.mfTable=this.inputMfTable||this.injectMfTable,this.onPageChangeSubscriber(this.mfTable.getPage()),this.mfTable.onPageChange.subscribe(this.onPageChangeSubscriber)},e.prototype.setPage=function(e){this.mfTable.setPage(e,this.rowsOnPage)},e.prototype.setRowsOnPage=function(e){this.mfTable.setPage(this.activePage,e),this.saveRowsOnPage&&this.stateManager.setPagination(e.toString())},d([t.Input("mfTable"),y("design:type",c)],e.prototype,"inputMfTable",void 0),d([t.Input("saveRowsOnPage"),y("design:type",Boolean)],e.prototype,"saveRowsOnPage",void 0),e=d([t.Component({selector:"mfPaginator",template:"<ng-content></ng-content>"}),P(0,t.Optional()),y("design:paramtypes",[c,o])],e)}(),m=function(e,t,n,a){var i,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},b=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},O=function(){function e(e){this.mfTable=e,this.entity=Object,this.isChecked=!1}return e.prototype.ngOnInit=function(){this.getIsChecked()},e.prototype.ngDoCheck=function(){this.getIsChecked()},e.prototype.getIsChecked=function(){this.isChecked=this.entity.__isSelected__},e.prototype.onChange=function(){this.entity.__isSelected__=!this.entity.__isSelected__,this.mfTable.addRemoveSelectedEntity(this.entity)},m([t.Input(),b("design:type",Object)],e.prototype,"entity",void 0),m([t.Input(),b("design:type",String)],e.prototype,"checkboxId",void 0),e=m([t.Component({selector:"mfRowSelector",template:'\n        <input type="checkbox" id="{{checkboxId}}" [checked]="isChecked" (change)="onChange()" />\n        <label attr.for="{{checkboxId}}"></label>\n        '}),b("design:paramtypes",[c])],e)}(),w=function(e,t,n,a){var i,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},R=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},S=function(){function e(e){var t=this;this.mfTable=e,this.isChecked=!1,e.onDataChange.subscribe(function(){t.isChecked=!1}),e.onSelectChange.subscribe(function(){t.isChecked=!1})}return e.prototype.onChange=function(e){this.isChecked=!this.isChecked,this.isChecked?this.mfTable.selectAllRows():this.mfTable.deselectAllRows()},w([t.Input("checkboxId"),R("design:type",String)],e.prototype,"checkboxId",void 0),e=w([t.Component({selector:"mfRowSelectorHead",template:'\n        <input type="checkbox" id="{{checkboxId}}" [checked]="isChecked" (change)="onChange($event)" />\n        <label attr.for="{{checkboxId}}"></label>\n        '}),R("design:paramtypes",[c])],e)}(),D=function(e,t,n,a){var i,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},C=function(){function e(){}return e=D([t.NgModule({imports:[n.CommonModule],providers:[o],declarations:[g,c,u,v,O,S],exports:[g,c,u,v,O,S]})],e)}();e.DataTableModule=C,e.DataTable=c,e.DefaultSorter=u,e.Paginator=v,e.BootstrapPaginator=g,e.RowSelector=O,e.RowSelectorHead=S,e.StateManager=o,Object.defineProperty(e,"__esModule",{value:!0})});